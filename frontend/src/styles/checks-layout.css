/* =========================================================
   ReleaseGuardian — CLEAN CSS (Single Source, Optimized)
   - Desktop: internal panel scroll + pinned footer
   - Mobile: normal page scroll + stacked layout
   - Symmetry: header-right matches details panel width
   - Evidence: collapse + focus (wider right panel)
   ========================================================= */

/* ---------- Base ---------- */
*,
*::before,
*::after {
  box-sizing: border-box;
}

:root {
  --rg-font: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

  --rg-ink: #0b1220;
  --rg-muted: #64748b;

  --rg-stroke: rgba(148, 163, 184, 0.38);
  --rg-stroke-strong: rgba(203, 213, 225, 0.82);

  --rg-card: rgba(255, 255, 255, 0.78);
  --rg-card-solid: #ffffff;

  --rg-shadow: 0 18px 42px rgba(15, 23, 42, 0.10);
  --rg-shadow-soft: 0 10px 26px rgba(15, 23, 42, 0.08);

  --rg-radius: 18px;
  --rg-radius-sm: 14px;

  /* Default right column width (symmetry) */
  --rg-right-col: 440px;

  --rg-bg-top: #f6f9ff;
  --rg-bg-bottom: #ffffff;
}

html,
body {
  margin: 0;
  max-width: 100%;
  overflow-x: hidden; /* iOS drift killer */
  font-family: var(--rg-font);
  color: var(--rg-ink);
  background: linear-gradient(180deg, var(--rg-bg-top) 0%, var(--rg-bg-bottom) 55%, #ffffff 100%);
}

#root {
  min-height: 100vh;
}

:where(button, select, a, input, textarea):focus-visible {
  outline: 3px solid rgba(59, 130, 246, 0.35);
  outline-offset: 2px;
  border-color: #60a5fa;
}

/* =========================================================
   Shell / container
   ========================================================= */
.rg-shell {
  min-height: 100vh;
}

.rg-container {
  width: 100%;
  margin: 0 auto;
  padding: 24px;
  max-width: none; /* full width */
}

/* =========================================================
   Header (desktop grid, mobile stack)
   IMPORTANT: header must never become its own scroll container
   ========================================================= */
.page-header {
  width: 100%;
  overflow: visible;
  height: auto;

  padding: 18px 18px 14px;
  margin-bottom: 16px;

  border-radius: var(--rg-radius);
  border: 1px solid var(--rg-stroke);
  box-shadow: var(--rg-shadow);
  backdrop-filter: blur(10px);

  background:
    radial-gradient(1200px 240px at 18% 0%, rgba(59, 130, 246, 0.12), transparent 55%),
    radial-gradient(900px 220px at 86% 10%, rgba(16, 185, 129, 0.10), transparent 55%),
    linear-gradient(180deg, rgba(255, 255, 255, 0.84) 0%, rgba(255, 255, 255, 0.62) 100%);
}

/* Prevent overflow in grid children */
.page-header *,
.rg-header * {
  min-width: 0;
}

.rg-header {
  display: grid;
  grid-template-columns: auto minmax(740px, 1fr) var(--rg-right-col);
  align-items: center;
  gap: 18px;
}

/* Left: brand */
.page-title {
  display: flex;
  align-items: center;
  gap: 12px;
}

.rg-logo {
  width: 56px;
  height: 56px;
  object-fit: contain;
  flex-shrink: 0;

  border-radius: 14px;
  box-shadow: 0 10px 18px rgba(15, 23, 42, 0.10);
  background: rgba(255, 255, 255, 0.65);
  padding: 6px;
}

.page-title h1 {
  margin: 0;
  font-size: 40px;
  line-height: 1.05;
  letter-spacing: -0.03em;
  font-weight: 850;
  color: var(--rg-ink);
}

.page-subtitle {
  display: inline-block;
  margin-top: 6px;
  font-size: 13px;
  color: var(--rg-muted);
}

/* Center: search card */
.rg-header__center {
  display: flex;
  justify-content: center;
  min-width: 0;
}

.rg-searchcard {
  width: 100%;
  max-width: 920px;
  padding: 14px 16px;

  border-radius: var(--rg-radius);
  border: 1px solid rgba(226, 232, 240, 0.65);
  background: rgba(255, 255, 255, 0.78);
  box-shadow: var(--rg-shadow-soft);
}

.rg-searchcard__title {
  margin: 0 0 4px 0;
  font-weight: 850;
  letter-spacing: -0.02em;
  color: var(--rg-ink);
  font-size: 15px;
}

.rg-searchcard__hint {
  margin: 0 0 12px 0;
  color: var(--rg-muted);
  font-size: 13px;
  font-weight: 500;
}

.rg-searchrow {
  display: flex;
  gap: 14px;
  align-items: center;
  min-width: 0;
}

.rg-searchinput {
  flex: 1 1 auto;
  min-width: 0;
  height: 44px;
  padding: 0 14px;

  border-radius: 14px;
  border: 1px solid rgba(148, 163, 184, 0.45);
  background: rgba(255, 255, 255, 0.92);
  color: var(--rg-ink);
}

.rg-searchinput:focus {
  border-color: #93c5fd;
  box-shadow: 0 0 0 4px rgba(147, 197, 253, 0.25);
  outline: none;
}

/* Retrieve button */
.rg-searchbtn {
  height: 44px;
  padding: 0 18px;

  border-radius: 16px;
  border: 1px solid rgba(15, 23, 42, 0.18);
  background: linear-gradient(180deg, #475569 0%, #334155 100%);
  color: #ffffff;

  font-weight: 850;
  cursor: pointer;
  white-space: nowrap;
  box-shadow: 0 14px 26px rgba(15, 23, 42, 0.18);
  transition: transform 120ms ease, filter 120ms ease;
}

.rg-searchbtn:hover {
  filter: brightness(0.98);
  transform: translateY(-1px);
}

.rg-header-error {
  margin-top: 10px;
  font-size: 13px;
  color: #b91c1c;
  font-weight: 600;
}

/* Right: filters + role */
.rg-header__right {
  width: var(--rg-right-col);
  min-width: var(--rg-right-col);
  max-width: var(--rg-right-col);

  display: flex;
  flex-direction: column;
  align-items: stretch;
  gap: 12px;

  padding: 16px 18px;
  border-radius: var(--rg-radius);
  border: 1px solid var(--rg-stroke-strong);
  background: rgba(255, 255, 255, 0.72);
  box-shadow: var(--rg-shadow-soft);
  backdrop-filter: blur(10px);
}

.rg-filterstitle {
  margin: 0 0 2px 0;
  font-weight: 850;
  font-size: 16px;
  letter-spacing: -0.02em;
  color: var(--rg-ink);
}

.rg-filtershint {
  margin: 0 0 12px 0;
  font-weight: 500;
  font-size: 13px;
  color: var(--rg-muted);
}

/* Decorative accent dot (adds meaning, not borders) */
.rg-filterstitle::before,
.rg-searchcard__title::before {
  content: "";
  display: inline-block;
  width: 7px;
  height: 7px;
  margin-right: 8px;
  border-radius: 999px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.85), rgba(56, 189, 248, 0.85));
  transform: translateY(-1px);
}

/* =========================================================
   Filters (segmented on desktop)
   ========================================================= */
.filters {
  display: inline-flex;
  align-items: center;
  gap: 0;

  padding: 6px;
  border-radius: 999px;
  border: 1px solid rgba(203, 213, 225, 0.95);
  background: rgba(248, 250, 252, 0.85);
  box-shadow: 0 10px 26px rgba(15, 23, 42, 0.08);

  width: 100%;
  justify-content: space-between;
}

.filter-btn {
  height: 38px;
  padding: 0 14px;

  border: 0;
  border-radius: 999px;
  background: transparent;

  cursor: pointer;
  font-size: 13px;
  font-weight: 850;
  letter-spacing: 0.02em;
  color: var(--rg-ink);
  white-space: nowrap;
  flex: 1;
}

.filter-btn + .filter-btn {
  border-left: 1px solid rgba(203, 213, 225, 0.95);
  border-radius: 0;
}

.filter-btn:hover {
  background: rgba(241, 245, 249, 0.65);
}

.filter-btn.active {
  background: rgba(224, 231, 255, 0.95);
  color: #1e3a8a;
  box-shadow: inset 0 0 0 1px rgba(199, 210, 254, 0.9);
}

/* =========================================================
   Role switch
   ========================================================= */
.role-switch {
  margin-top: 2px;
  padding-top: 12px;
  border-top: 1px solid rgba(226, 232, 240, 0.9);
}

.role-switch label {
  display: grid;
  grid-template-columns: 110px 1fr;
  align-items: center;
  gap: 12px;

  margin: 0;
  font-size: 14px;
  color: #334155;
  font-weight: 650;
}

.role-switch select {
  height: 42px;
  padding: 0 14px;

  border: 1px solid rgba(203, 213, 225, 0.95);
  border-radius: 14px;
  background: rgba(255, 255, 255, 0.95);
  color: var(--rg-ink);
  font-size: 14px;

  box-shadow: 0 10px 22px rgba(15, 23, 42, 0.08);
}

/* =========================================================
   Main layout
   ========================================================= */
.checks-layout {
  display: grid;
  grid-template-columns: 1fr var(--rg-right-col);
  gap: 24px;
  align-items: stretch;
}

.checks-table {
  min-width: 0;
}

.checks-panel {
  min-width: 0;
  padding-left: 24px;
  position: relative;
  border-left: 1px solid rgba(226, 232, 240, 0.65);
}

.checks-panel::before {
  content: "";
  position: absolute;
  left: -14px;
  top: 0;
  bottom: 0;
  width: 28px;
  pointer-events: none;
  background: linear-gradient(to right, rgba(15, 23, 42, 0.06), transparent);
}

/* =========================================================
   Table (no vertical grid lines)
   ========================================================= */
.table-shell {
  border: 1px solid rgba(226, 232, 240, 0.75);
  border-radius: var(--rg-radius);
  background: rgba(255, 255, 255, 0.82);
  box-shadow: var(--rg-shadow-soft);

  overflow: auto;
  min-height: 220px;
}

.table-shell table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
}

.table-shell th,
.table-shell td {
  border-left: none;
  border-right: none;
  border-bottom: 1px solid rgba(226, 232, 240, 0.75);
  vertical-align: top;
}

.table-shell thead th {
  background: rgba(248, 250, 252, 0.86);
  position: sticky;
  top: 0;
  z-index: 5;
  backdrop-filter: blur(8px);
  box-shadow: 0 1px 0 rgba(226, 232, 240, 0.90);
}

.table-shell tbody tr:hover {
  background: rgba(248, 250, 252, 0.75);
}

.table-shell tbody tr:last-child td {
  border-bottom: none;
}

.col-id { width: 40%; }
.col-status { width: 20%; }
.col-created { width: 40%; }

.col-sub {
  font-size: 11px;
  font-weight: 500;
  color: #6b7280;
  margin-top: 2px;
}

.row-active {
  background: rgba(241, 245, 249, 0.7);
}

/* =========================================================
   Status pill
   ========================================================= */
.status-pill {
  display: inline-flex;
  align-items: center;
  height: 22px;
  padding: 0 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 850;
  border: 1px solid rgba(203, 213, 225, 0.75);
  background: rgba(248, 250, 252, 0.9);
  color: #111827;
}

.status-approved {
  background: #ecfdf5;
  border-color: #a7f3d0;
  color: #065f46;
}

.status-pending {
  background: #fffbeb;
  border-color: #fde68a;
  color: #92400e;
}

.status-rejected {
  background: #fef2f2;
  border-color: #fecaca;
  color: #991b1b;
}

/* =========================================================
   Skeletons
   ========================================================= */
.skel-row td { padding: 10px 8px; }

.skel {
  display: inline-block;
  height: 12px;
  border-radius: 6px;
  background: #e5e7eb;
  position: relative;
  overflow: hidden;
}

.skel::after {
  content: "";
  position: absolute;
  inset: 0;
  transform: translateX(-100%);
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.55), transparent);
  animation: skel-shimmer 1.1s infinite;
}

@keyframes skel-shimmer {
  100% { transform: translateX(100%); }
}

/* =========================================================
   Right panel card
   ========================================================= */
.panel-card {
  border: 1px solid rgba(226, 232, 240, 0.75);
  border-radius: var(--rg-radius);
  padding: 12px;
  background: rgba(255, 255, 255, 0.86);
  box-shadow: var(--rg-shadow-soft);
}

.panel-header {
  position: sticky;
  top: 0;
  z-index: 10;

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;

  padding: 10px 12px;
  margin: -12px -12px 12px;
  background: rgba(255, 255, 255, 0.92);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid rgba(226, 232, 240, 0.85);
}

.panel-back {
  height: 34px;
  padding: 0 12px;

  border: 1px solid rgba(226, 232, 240, 0.95);
  border-radius: 12px;
  background: rgba(248, 250, 252, 0.9);
  font-weight: 850;
  cursor: pointer;
}

.panel-back:hover {
  background: rgba(241, 245, 249, 0.9);
}

/* =========================================================
   Footer
   ========================================================= */
.rg-footer {
  margin-top: 18px;
  padding-top: 12px;
  border-top: 1px solid rgba(226, 232, 240, 0.9);

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;

  color: #6b7280;
  font-size: 13px;
}

.env-badge {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid rgba(226, 232, 240, 0.9);
  background: rgba(255, 255, 255, 0.75);
  color: #64748b;
  font-weight: 800;
  letter-spacing: 0.02em;
  font-size: 12px;
}

/* =========================================================
   Evidence: collapsible + focus
   ========================================================= */
.evidence-card {
  margin-top: 14px;
  border: 1px solid rgba(226, 232, 240, 0.75);
  border-radius: 16px;
  background: rgba(255, 255, 255, 0.88);
  box-shadow: 0 10px 22px rgba(15, 23, 42, 0.06);
  padding: 12px;
}

.evidence-card__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.evidence-card__title {
  display: flex;
  align-items: baseline;
  gap: 10px;
}

.evidence-card__title strong {
  font-size: 16px;
  letter-spacing: -0.02em;
}

.evidence-card__count {
  color: var(--rg-muted);
  font-size: 13px;
  font-weight: 600;
}

.evidence-card__actions {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.evidence-action-btn {
  height: 32px;
  padding: 0 10px;
  border-radius: 10px;
  border: 1px solid rgba(226, 232, 240, 0.95);
  background: rgba(248, 250, 252, 0.9);
  font-weight: 850;
  cursor: pointer;
}

.evidence-action-btn:hover {
  background: rgba(241, 245, 249, 0.95);
}

.evidence-card__body {
  margin-top: 10px;
  overflow: hidden;
  transition: max-height 180ms ease, opacity 180ms ease;
  max-height: 2000px;
  opacity: 1;
}

.evidence-card.is-collapsed .evidence-card__body {
  max-height: 0;
  opacity: 0.35;
  margin-top: 0;
}

/* Make evidence text wrap nicely */
.evidence-card pre,
.evidence-card code {
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* =========================================================
   Focus mode: widen right panel + fade header context
   ========================================================= */
@media (min-width: 901px) {
  body.rg-evidence-focus {
    --rg-right-col: 620px;
  }

  /* Slightly tighten divider when focused */
  body.rg-evidence-focus .checks-panel {
    padding-left: 18px;
  }

  /* Fade out brand + search (keep filters readable) */
  body.rg-evidence-focus .rg-header__left,
  body.rg-evidence-focus .rg-header__center {
    opacity: 0.22;
    filter: blur(0.3px);
    pointer-events: none; /* prevents accidental clicks */
  }

  /* Smooth layout transitions */
  .checks-layout,
  .rg-header {
    transition: grid-template-columns 180ms ease;
  }

  .rg-header__left,
  .rg-header__center {
    transition: opacity 160ms ease, filter 160ms ease;
  }
}

/* =========================================================
   DESKTOP: lock page scroll, scroll inside columns, pinned footer
   ========================================================= */
@media (min-width: 901px) {
  html,
  body,
  #root {
    height: 100%;
  }

  body {
    overflow: hidden;
  }

  .rg-shell {
    height: 100%;
  }

  .rg-container {
    height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 24px 32px 16px;
  }

  .checks-layout {
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }

  .checks-table,
  .checks-panel {
    min-height: 0;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .rg-footer {
    margin-top: 0;
    flex-shrink: 0;
    position: sticky;
    bottom: 0;
    background: transparent;
    padding-bottom: 10px;
  }
}

/* =========================================================
   MOBILE: stacked layout + normal page scroll
   ========================================================= */
@media (max-width: 900px) {
  .rg-container {
    padding-left: max(16px, env(safe-area-inset-left));
    padding-right: max(16px, env(safe-area-inset-right));
    padding-top: 16px;
    padding-bottom: 16px;
  }

  .rg-header {
    grid-template-columns: 1fr;
    gap: 12px;
    align-items: stretch;
  }

  .rg-header__center {
    justify-content: stretch;
  }

  .rg-header__right {
    width: 100%;
    min-width: 0;
    max-width: none;
  }

  /* Search row stacks */
  .rg-searchrow {
    flex-direction: column;
    align-items: stretch;
  }

  .rg-searchbtn {
    width: 100%;
    height: 52px; /* nicer on mobile */
    font-size: 18px;
  }

  /* Filters as 2x2 grid on mobile */
  .filters {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px;

    width: 100%;
    padding: 0;
    border: 0;
    background: transparent;
    box-shadow: none;
  }

  .filter-btn {
    width: 100%;
    height: 44px;
    border-radius: 14px;
    font-size: 14px;
    padding: 0 12px;
    border: 1px solid rgba(203, 213, 225, 0.95);
    background: rgba(255, 255, 255, 0.95);
  }

  .filter-btn + .filter-btn {
    border-left: none;
    border-radius: 14px;
  }

  .filter-btn.active {
    background: rgba(99, 102, 241, 0.12);
    border-color: rgba(99, 102, 241, 0.25);
  }

  /* iOS: avoid zoom on select */
  .role-switch select {
    font-size: 16px;
  }

  .checks-layout {
    grid-template-columns: 1fr;
    gap: 16px;
  }

  .checks-panel {
    border-left: none;
    padding-left: 0;
    border-top: 1px solid rgba(226, 232, 240, 0.85);
    padding-top: 16px;
  }

  .checks-panel::before {
    display: none;
  }

  .checks-table,
  .checks-panel {
    overflow: visible;
  }

  .table-shell {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .table-shell table {
    min-width: 560px;
  }

  /* Details header not sticky on mobile */
  .panel-header {
    position: static;
    margin: 0 0 10px 0;
    padding: 0;
    background: transparent;
    backdrop-filter: none;
    border-bottom: none;
  }
}

/* Extra small phones: reduce title */
@media (max-width: 520px) {
  .page-title h1 {
    font-size: 34px;
    line-height: 1.08;
    overflow-wrap: anywhere;
    word-break: break-word;
  }
}

/* =========================================================
   Evidence focus — fade header brand/search on DESKTOP
   ========================================================= */
@media (min-width: 901px) {
  /* Fade the whole left+center area when focusing evidence */
  body.rg-evidence-focus .rg-header__left,
  body.rg-evidence-focus .rg-header__center {
    opacity: 0.18;
    filter: blur(0.4px);
    transform: translateY(-1px);
    transition: opacity 180ms ease, filter 180ms ease, transform 180ms ease;
    pointer-events: none; /* prevent clicks while faded */
  }

  /* Keep right controls fully visible */
  body.rg-evidence-focus .rg-header__right {
    opacity: 1;
    filter: none;
    transform: none;
    pointer-events: auto;
  }
}

/* Make sure normal state transitions feel smooth too */
.rg-header__left,
.rg-header__center,
.rg-header__right {
  transition: opacity 180ms ease, filter 180ms ease, transform 180ms ease;
}
